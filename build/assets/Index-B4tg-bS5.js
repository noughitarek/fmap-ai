import{r as c,W as A,j as e,Y,a as d,B as m,y as S}from"./app-dtYpB2pc.js";import{P as J}from"./Page-AWksGIBO.js";import{W as O,B as M,P as Q,T as V,S as X,C as Z,H as ee,a as se,b as te,U as _,c as ae,K as re,d as le,e as ne}from"./Webmaster-CrnXKKSZ.js";import{D as T}from"./DeleteModal-ByeN5Flg.js";import{R as ce}from"./react-loading-SAuKohaU.js";import{F as ie}from"./facebook-Dv8De7Q2.js";import{h as g}from"./button-BLv4ZLOr.js";import"./createLucideIcon-CyBU6K7F.js";import"./save-B9B5oMJb.js";import"./transition-mFquH0Tb.js";import"./render-CcaDLSFt.js";import"./Modal-3p-ZljzZ.js";import"./disabled-CQgWAbIn.js";const ke=({auth:E,groups:o,from:oe,to:de,total:me,menu:I})=>{const[L,x]=c.useState(!1),[h,w]=c.useState(!1),[N,F]=c.useState(!1),[B,u]=c.useState(!1),[R,y]=c.useState(!1),j=A({account:0}),p=A({group:0}),[t,G]=c.useState(o.length>0?o[0]:null),[a,b]=c.useState(o.length>0?o[0].accounts:[]),P=s=>{const l=Date.now()-s,n=60*1e3,f=60*n,k=24*f;return l<n?"few seconds ago":l<f?`${Math.floor(l/n)} minutes ago`:l<k?`${Math.floor(l/f)} hours ago`:`${Math.floor(l/k)} days ago`},i=a.length>0?a.reduce((s,r)=>new Date(r.updated_at).getTime()>new Date(s.updated_at).getTime()?r:s):null,$=i&&i.updated_by?i.updated_by.name:"",W=i?P(new Date(i.updated_at).getTime()):"",H=async()=>{y(!0);try{await j.delete(route("accounts.destroy",{id:j.data.account})),m.success("Account has been deleted successfully"),S.get(route("accounts.index"))}catch(s){m.error("Error deleting the account"),console.error("Error details:",s)}finally{y(!1),u(!1)}},K=async()=>{w(!0);try{await p.delete(route("accounts.groups.destroy",{id:p.data.group})),m.success("Group of accounts has been deleted successfully"),S.get(route("accounts.index"))}catch(s){m.error("Error deleting the group of accounts"),console.error("Error details:",s)}finally{w(!1),x(!1)}},U=(s,r)=>{s.preventDefault(),p.setData({group:r}),x(!0)},q=(s,r)=>{s.preventDefault(),j.setData({account:r}),u(!0)},v=()=>{x(!1),u(!1)};c.useEffect(()=>{b(t?t.accounts:[])},[t]);const z=s=>{F(s.target.value!="");const r=t?t.accounts:[],l=s.target.value.toLowerCase(),D=r.filter(n=>n.name&&n.name.toLowerCase().includes(l)||n.description&&n.description.toLowerCase().includes(l)||n.created_by&&n.created_by.name.toLowerCase().includes(l)||n.username&&n.username.toLowerCase().includes(l));b(D)};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{title:"Accounts"}),e.jsx(O,{user:E.user,menu:I,breadcrumb:e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:"Accounts"}),children:e.jsx(J,{title:"Accounts",header:e.jsx(e.Fragment,{}),children:e.jsxs("div",{className:"grid grid-cols-12 gap-6 mt-8",children:[e.jsxs("div",{className:"col-span-12 lg:col-span-3 2xl:col-span-2",children:[e.jsx("h2",{className:"intro-y text-lg font-medium mr-auto mt-2",children:"Groups"}),e.jsxs("div",{className:"intro-y box bg-primary p-5 mt-6",children:[e.jsxs(d,{href:route("accounts.groups.create"),type:"button",className:"btn text-slate-600 dark:text-slate-300 w-full bg-white dark:bg-darkmode-300 dark:border-darkmode-300 mt-1",children:[e.jsx(M,{className:"w-4 h-4 mr-2"})," Create a group"]}),t&&e.jsxs(d,{href:route("accounts.groups.edit",t.id),className:"btn text-slate-600 dark:text-slate-300 w-full bg-white dark:bg-darkmode-300 dark:border-darkmode-300 mt-1",children:[e.jsx(Q,{className:"w-4 h-4 mr-2 text-danger"})," Edit the group"]}),t&&e.jsx(g,{onClick:s=>U(s,t.id),disabled:h,className:"btn text-slate-600 dark:text-slate-300 w-full dark:bg-darkmode-300 dark:border-darkmode-300 mt-1 bg-white",children:h?e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{type:"spin",color:"#ff",height:24,width:24}),e.jsx("span",{className:"ml-2",children:"Deleting..."})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"w-4 h-4 mr-2 text-red-500"}),e.jsx("span",{children:"Delete the group"})]})}),e.jsx("div",{className:"border-t border-white/10 dark:border-darkmode-400 mt-6 pt-6 text-white",children:o.map(s=>{const r=t&&s.id===t.id;return e.jsxs(g,{onClick:()=>G(s),className:`flex items-center px-3 py-2 rounded-md mt-2 ${r?"bg-white/10 dark:bg-darkmode-700 font-medium":""}`,children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),s.name]},s.name)})})]})]}),e.jsxs("div",{className:"col-span-12 lg:col-span-9 2xl:col-span-10",children:[e.jsxs("div",{className:"intro-y flex flex-col-reverse sm:flex-row items-center",children:[e.jsxs("div",{className:"w-full sm:w-auto relative mr-auto mt-3 sm:mt-0",children:[e.jsx(X,{className:"w-4 h-4 absolute my-auto inset-y-0 ml-3 left-0 z-10 text-slate-500"}),e.jsx("input",{type:"text",className:"form-control w-full sm:w-64 box px-10",placeholder:"Search account",onChange:z}),e.jsx("div",{className:"inbox-filter dropdown absolute inset-y-0 mr-3 right-0 flex items-center","data-tw-placement":"bottom-start",children:e.jsx(Z,{className:"dropdown-toggle w-4 h-4 cursor-pointer text-slate-500",role:"button","aria-expanded":"false","data-tw-toggle":"dropdown"})})]}),e.jsx("div",{className:"w-full sm:w-auto flex",children:e.jsx(d,{href:route("accounts.create"),className:"btn btn-primary shadow-md mr-2",children:"Create a Account"})})]}),e.jsx("div",{className:"intro-y overflow-auto",children:e.jsxs("table",{className:"table table-report -mt-2",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"whitespace-nowrap",children:"#"}),e.jsx("th",{className:"whitespace-nowrap",children:"Account"}),e.jsx("th",{className:"whitespace-nowrap",children:"Created"}),e.jsx("th",{className:"whitespace-nowrap",children:"Credentials"}),e.jsx("th",{className:"whitespace-nowrap",children:"Rates"}),e.jsx("th",{className:"whitespace-nowrap",children:"Action"})]})}),e.jsx("tbody",{children:a&&a.map((s,r)=>e.jsxs("tr",{className:"intro-x",children:[e.jsxs("td",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ee,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.id})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(se,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.accounts_group.name})]})]}),e.jsxs("td",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.name})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(te,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.description&&s.description.length>10?s.description.substring(0,10)+"...":s.description})]})]}),e.jsxs("td",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.created_by.name})]}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(ae,{className:"h-4 w-4 text-gray-500 mr-2"}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(s.created_at).toLocaleString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"})})]})]}),e.jsxs("td",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.username})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(re,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx("span",{className:"text-sm text-gray-500",children:s.password})]})]}),e.jsxs("td",{children:[e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-primary",children:s.total_listings})}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-warning",children:s.total_messages})}),e.jsx("div",{className:"flex items-center",children:e.jsx("span",{className:"text-success",children:s.total_orders})})]}),e.jsx("td",{className:"table-report__action w-56",children:e.jsxs("div",{className:"flex justify-center items-center",children:[e.jsxs(d,{className:"flex items-center mr-3",href:route("accounts.edit",{account:s.id}),children:[e.jsx(le,{className:"w-4 h-4 mr-1"})," Edit"]}),e.jsxs(g,{className:"flex items-center text-danger",onClick:l=>q(l,s.id),children:[e.jsx(ne,{className:"w-4 h-4 mr-1"})," Delete"]})]})})]},r))})]})}),e.jsx(T,{showDeleteModal:B,handleDeleteCancel:v,handleDeleteConfirm:H,deleting:R}),e.jsx(T,{showDeleteModal:L,handleDeleteCancel:v,handleDeleteConfirm:K,deleting:h}),e.jsxs("div",{className:"p-5 flex flex-col sm:flex-row items-center text-center sm:text-left text-slate-500",children:[!t&&e.jsx("div",{children:"No group !"}),t&&a.length>0&&e.jsxs("div",{children:[a==null?void 0:a.length," of ",a==null?void 0:a.length," in ",t==null?void 0:t.name]}),t&&a.length<=0&&!N&&e.jsxs("div",{children:["No accounts in ",t==null?void 0:t.name," !"]}),t&&a.length<=0&&N&&e.jsxs("div",{children:["No results has been found in ",t==null?void 0:t.name," !"]}),i&&e.jsxs("div",{className:"sm:ml-auto mt-2 sm:mt-0",children:["Last activity: ",W," by ",$]})]})]})]})})})]})};export{ke as default};
